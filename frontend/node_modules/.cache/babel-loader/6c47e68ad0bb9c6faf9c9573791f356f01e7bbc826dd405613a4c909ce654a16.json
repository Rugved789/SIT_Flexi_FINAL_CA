{"ast":null,"code":"import React,{useEffect,useState}from'react';import{useParams,useNavigate}from'react-router-dom';import api from'../utils/api';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Donate=()=>{const{id}=useParams();const navigate=useNavigate();const[campaign,setCampaign]=useState(null);const[donationType,setDonationType]=useState('money');const[amount,setAmount]=useState('');const[itemDetails,setItemDetails]=useState('');useEffect(()=>{const fetch=async()=>{try{var _res$data;const res=await api.get(\"/campaigns/\".concat(id));setCampaign(((_res$data=res.data)===null||_res$data===void 0?void 0:_res$data.campaign)||null);}catch(err){console.error('Failed to fetch campaign',err);}};fetch();},[id]);const[errors,setErrors]=useState([]);const[success,setSuccess]=useState('');const handleSubmit=async e=>{e.preventDefault();setErrors([]);setSuccess('');try{const payload={campaignId:id,donationType};if(donationType==='money'){payload.amount=Number(amount);}else{payload.itemDetails=itemDetails;}await api.post('/donations/create',payload);setSuccess('Donation successful');// navigate after brief delay so user sees success\nsetTimeout(()=>navigate('/donor-dashboard'),800);}catch(err){var _err$response;console.error('Donation error',err);const resp=(_err$response=err.response)===null||_err$response===void 0?void 0:_err$response.data;if(resp&&resp.error&&Array.isArray(resp.error.details)){const msgs=resp.error.details.map(d=>d.message||d.msg||JSON.stringify(d));setErrors(msgs);return;}setErrors([(resp===null||resp===void 0?void 0:resp.message)||'Donation failed']);}};if(!campaign)return/*#__PURE__*/_jsx(\"p\",{children:\"Loading campaign...\"});return/*#__PURE__*/_jsxs(\"div\",{className:\"donate-page\",children:[/*#__PURE__*/_jsxs(\"h2\",{children:[\"Donate to \",campaign.title]}),/*#__PURE__*/_jsx(\"p\",{children:campaign.description}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[errors.length>0&&/*#__PURE__*/_jsx(\"div\",{className:\"form-errors\",children:/*#__PURE__*/_jsx(\"ul\",{children:errors.map((err,idx)=>/*#__PURE__*/_jsx(\"li\",{style:{color:'red'},children:err},idx))})}),success&&/*#__PURE__*/_jsx(\"div\",{className:\"form-success\",style:{color:'green'},children:success}),/*#__PURE__*/_jsx(\"label\",{children:\"Donation Type\"}),/*#__PURE__*/_jsxs(\"select\",{value:donationType,onChange:e=>setDonationType(e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{value:\"money\",children:\"Money\"}),/*#__PURE__*/_jsx(\"option\",{value:\"items\",children:\"Items\"})]}),donationType==='money'?/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"Amount (\\u20B9)\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",value:amount,onChange:e=>setAmount(e.target.value),required:true,min:\"1\"})]}):/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"Item details\"}),/*#__PURE__*/_jsx(\"textarea\",{value:itemDetails,onChange:e=>setItemDetails(e.target.value),required:true})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"Confirm Donation\"})]})]});};export default Donate;","map":{"version":3,"names":["React","useEffect","useState","useParams","useNavigate","api","jsx","_jsx","jsxs","_jsxs","Donate","id","navigate","campaign","setCampaign","donationType","setDonationType","amount","setAmount","itemDetails","setItemDetails","fetch","_res$data","res","get","concat","data","err","console","error","errors","setErrors","success","setSuccess","handleSubmit","e","preventDefault","payload","campaignId","Number","post","setTimeout","_err$response","resp","response","Array","isArray","details","msgs","map","d","message","msg","JSON","stringify","children","className","title","description","onSubmit","length","idx","style","color","value","onChange","target","type","required","min"],"sources":["E:/SEM5/Mini_Project/donation-management-system/frontend/src/pages/Donate.jsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { useParams, useNavigate } from 'react-router-dom';\r\nimport api from '../utils/api';\r\n\r\nconst Donate = () => {\r\n  const { id } = useParams();\r\n  const navigate = useNavigate();\r\n  const [campaign, setCampaign] = useState(null);\r\n  const [donationType, setDonationType] = useState('money');\r\n  const [amount, setAmount] = useState('');\r\n  const [itemDetails, setItemDetails] = useState('');\r\n\r\n  useEffect(() => {\r\n    const fetch = async () => {\r\n      try {\r\n        const res = await api.get(`/campaigns/${id}`);\r\n        setCampaign(res.data?.campaign || null);\r\n      } catch (err) {\r\n        console.error('Failed to fetch campaign', err);\r\n      }\r\n    };\r\n    fetch();\r\n  }, [id]);\r\n\r\n  const [errors, setErrors] = useState([]);\r\n  const [success, setSuccess] = useState('');\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    setErrors([]);\r\n    setSuccess('');\r\n    try {\r\n      const payload = {\r\n        campaignId: id,\r\n        donationType,\r\n      };\r\n      if (donationType === 'money') {\r\n        payload.amount = Number(amount);\r\n      } else {\r\n        payload.itemDetails = itemDetails;\r\n      }\r\n\r\n      await api.post('/donations/create', payload);\r\n      setSuccess('Donation successful');\r\n      // navigate after brief delay so user sees success\r\n      setTimeout(() => navigate('/donor-dashboard'), 800);\r\n    } catch (err) {\r\n      console.error('Donation error', err);\r\n      const resp = err.response?.data;\r\n      if (resp && resp.error && Array.isArray(resp.error.details)) {\r\n        const msgs = resp.error.details.map(d => d.message || d.msg || JSON.stringify(d));\r\n        setErrors(msgs);\r\n        return;\r\n      }\r\n      setErrors([resp?.message || 'Donation failed']);\r\n    }\r\n  };\r\n\r\n  if (!campaign) return <p>Loading campaign...</p>;\r\n\r\n  return (\r\n    <div className=\"donate-page\">\r\n      <h2>Donate to {campaign.title}</h2>\r\n      <p>{campaign.description}</p>\r\n      <form onSubmit={handleSubmit}>\r\n        {errors.length > 0 && (\r\n          <div className=\"form-errors\">\r\n            <ul>\r\n              {errors.map((err, idx) => (\r\n                <li key={idx} style={{ color: 'red' }}>{err}</li>\r\n              ))}\r\n            </ul>\r\n          </div>\r\n        )}\r\n        {success && (\r\n          <div className=\"form-success\" style={{ color: 'green' }}>{success}</div>\r\n        )}\r\n        <label>Donation Type</label>\r\n        <select value={donationType} onChange={(e) => setDonationType(e.target.value)}>\r\n          <option value=\"money\">Money</option>\r\n          <option value=\"items\">Items</option>\r\n        </select>\r\n\r\n        {donationType === 'money' ? (\r\n          <div>\r\n            <label>Amount (â‚¹)</label>\r\n            <input type=\"number\" value={amount} onChange={(e) => setAmount(e.target.value)} required min=\"1\" />\r\n          </div>\r\n        ) : (\r\n          <div>\r\n            <label>Item details</label>\r\n            <textarea value={itemDetails} onChange={(e) => setItemDetails(e.target.value)} required />\r\n          </div>\r\n        )}\r\n\r\n        <button type=\"submit\">Confirm Donation</button>\r\n      </form>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Donate;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}