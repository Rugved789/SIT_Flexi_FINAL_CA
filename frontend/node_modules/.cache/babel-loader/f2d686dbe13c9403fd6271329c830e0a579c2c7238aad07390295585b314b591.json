{"ast":null,"code":"import _objectSpread from\"E:/SEM5/Mini_Project/donation-management-system/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useEffect,useState}from\"react\";import api from'../../utils/api';import\"../donor/donor.css\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const BrowseCampaigns=()=>{const[campaigns,setCampaigns]=useState([]);const[donationData,setDonationData]=useState({amount:\"\",type:\"money\"});const[selectedCampaign,setSelectedCampaign]=useState(null);// Fetch all campaigns\nuseEffect(()=>{const fetchCampaigns=async()=>{try{const res=await api.get('/campaigns');// API returns { timestamp, campaigns }\nconst data=res.data&&res.data.campaigns?res.data.campaigns:res.data;// Ensure campaigns is an array before setting state\nsetCampaigns(Array.isArray(data)?data:[]);}catch(err){console.error(\"Error fetching campaigns:\",err);}};fetchCampaigns();},[]);const handleDonate=async e=>{e.preventDefault();const token=localStorage.getItem(\"token\");try{await api.post(\"/donations/create\",{campaignId:selectedCampaign._id,amount:Number(donationData.amount),donationType:donationData.type});alert(\"✅ Donation Successful!\");setSelectedCampaign(null);setDonationData({amount:\"\",type:\"money\"});}catch(err){var _err$response,_err$response2,_err$response3;// surface detailed validation errors when available\nconst resp=(_err$response=err.response)===null||_err$response===void 0?void 0:_err$response.data;if(resp&&resp.error&&Array.isArray(resp.error.details)&&resp.error.details.length>0){// Be defensive: details may or may not include `field`/`message` keys depending on source\nconst msgs=resp.error.details.map(d=>{if(typeof d==='string')return d;const msg=d.message||d.msg||d.message||JSON.stringify(d);const fld=d.field||d.param||'';return fld?\"\".concat(fld,\": \").concat(msg):msg;}).join('\\n');alert('Validation failed:\\n'+msgs);return;}// Fallbacks\nconst fallback=(resp===null||resp===void 0?void 0:resp.message)||((_err$response2=err.response)===null||_err$response2===void 0?void 0:_err$response2.statusText)||err.message||'Unknown error';console.error('Donation create error details:',((_err$response3=err.response)===null||_err$response3===void 0?void 0:_err$response3.data)||err);alert(\"❌ Error making donation: \"+fallback);}};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Active Campaigns\"}),campaigns.length===0?/*#__PURE__*/_jsx(\"p\",{children:\"No campaigns found.\"}):/*#__PURE__*/_jsx(\"div\",{className:\"campaign-grid\",children:campaigns.map(c=>/*#__PURE__*/_jsxs(\"div\",{className:\"campaign-card\",children:[/*#__PURE__*/_jsx(\"h3\",{children:c.title}),/*#__PURE__*/_jsx(\"p\",{children:c.description}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Goal: \\u20B9\",c.goalAmount]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setSelectedCampaign(c),children:\"Donate Now\"})]},c._id))}),selectedCampaign&&/*#__PURE__*/_jsx(\"div\",{className:\"modal-overlay\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal\",children:[/*#__PURE__*/_jsxs(\"h3\",{children:[\"Donate to \",selectedCampaign.title]}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleDonate,children:[/*#__PURE__*/_jsx(\"label\",{children:\"Donation Type\"}),/*#__PURE__*/_jsxs(\"select\",{value:donationData.type,onChange:e=>setDonationData(_objectSpread(_objectSpread({},donationData),{},{type:e.target.value})),children:[/*#__PURE__*/_jsx(\"option\",{value:\"money\",children:\"Money\"}),/*#__PURE__*/_jsx(\"option\",{value:\"items\",children:\"Items\"})]}),donationData.type==='money'?/*#__PURE__*/_jsx(\"input\",{type:\"number\",placeholder:\"Enter amount\",value:donationData.amount,onChange:e=>setDonationData(_objectSpread(_objectSpread({},donationData),{},{amount:e.target.value})),required:true}):/*#__PURE__*/_jsx(\"textarea\",{placeholder:\"Describe the items you want to donate\",value:donationData.itemDetails||'',onChange:e=>setDonationData(_objectSpread(_objectSpread({},donationData),{},{itemDetails:e.target.value})),required:true}),/*#__PURE__*/_jsxs(\"div\",{className:\"modal-actions\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"Confirm Donation\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"cancel-btn\",onClick:()=>setSelectedCampaign(null),children:\"Cancel\"})]})]})]})})]});};export default BrowseCampaigns;","map":{"version":3,"names":["React","useEffect","useState","api","jsx","_jsx","jsxs","_jsxs","BrowseCampaigns","campaigns","setCampaigns","donationData","setDonationData","amount","type","selectedCampaign","setSelectedCampaign","fetchCampaigns","res","get","data","Array","isArray","err","console","error","handleDonate","e","preventDefault","token","localStorage","getItem","post","campaignId","_id","Number","donationType","alert","_err$response","_err$response2","_err$response3","resp","response","details","length","msgs","map","d","msg","message","JSON","stringify","fld","field","param","concat","join","fallback","statusText","children","className","c","title","description","goalAmount","onClick","onSubmit","value","onChange","_objectSpread","target","placeholder","required","itemDetails"],"sources":["E:/SEM5/Mini_Project/donation-management-system/frontend/src/pages/donor/BrowseCampaigns.jsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport api from '../../utils/api';\r\nimport \"../donor/donor.css\";\r\n\r\nconst BrowseCampaigns = () => {\r\n  const [campaigns, setCampaigns] = useState([]);\r\n  const [donationData, setDonationData] = useState({ amount: \"\", type: \"money\" });\r\n  const [selectedCampaign, setSelectedCampaign] = useState(null);\r\n\r\n  // Fetch all campaigns\r\n  useEffect(() => {\r\n    const fetchCampaigns = async () => {\r\n      try {\r\n  const res = await api.get('/campaigns');\r\n        // API returns { timestamp, campaigns }\r\n        const data = res.data && res.data.campaigns ? res.data.campaigns : res.data;\r\n        // Ensure campaigns is an array before setting state\r\n        setCampaigns(Array.isArray(data) ? data : []);\r\n      } catch (err) {\r\n        console.error(\"Error fetching campaigns:\", err);\r\n      }\r\n    };\r\n    fetchCampaigns();\r\n  }, []);\r\n\r\n    const handleDonate = async (e) => {\r\n    e.preventDefault();\r\n    const token = localStorage.getItem(\"token\");\r\n\r\n    try {\r\n        await api.post(\r\n          \"/donations/create\",\r\n          {\r\n            campaignId: selectedCampaign._id,\r\n            amount: Number(donationData.amount),\r\n            donationType: donationData.type,\r\n          }\r\n        );\r\n\r\n      alert(\"✅ Donation Successful!\");\r\n      setSelectedCampaign(null);\r\n      setDonationData({ amount: \"\", type: \"money\" });\r\n    } catch (err) {\r\n      // surface detailed validation errors when available\r\n      const resp = err.response?.data;\r\n      if (resp && resp.error && Array.isArray(resp.error.details) && resp.error.details.length > 0) {\r\n        // Be defensive: details may or may not include `field`/`message` keys depending on source\r\n        const msgs = resp.error.details.map(d => {\r\n          if (typeof d === 'string') return d;\r\n          const msg = d.message || d.msg || d.message || JSON.stringify(d);\r\n          const fld = d.field || d.param || '';\r\n          return fld ? `${fld}: ${msg}` : msg;\r\n        }).join('\\n');\r\n        alert('Validation failed:\\n' + msgs);\r\n        return;\r\n      }\r\n\r\n      // Fallbacks\r\n      const fallback = resp?.message || err.response?.statusText || err.message || 'Unknown error';\r\n      console.error('Donation create error details:', err.response?.data || err);\r\n      alert(\"❌ Error making donation: \" + fallback);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <h2>Active Campaigns</h2>\r\n\r\n      {campaigns.length === 0 ? (\r\n        <p>No campaigns found.</p>\r\n      ) : (\r\n        <div className=\"campaign-grid\">\r\n          {campaigns.map((c) => (\r\n            <div key={c._id} className=\"campaign-card\">\r\n              <h3>{c.title}</h3>\r\n              <p>{c.description}</p>\r\n              <p>Goal: ₹{c.goalAmount}</p>\r\n              <button onClick={() => setSelectedCampaign(c)}>Donate Now</button>\r\n            </div>\r\n          ))}\r\n        </div>\r\n      )}\r\n\r\n      {/* Donation Modal */}\r\n      {selectedCampaign && (\r\n        <div className=\"modal-overlay\">\r\n          <div className=\"modal\">\r\n            <h3>Donate to {selectedCampaign.title}</h3>\r\n            <form onSubmit={handleDonate}>\r\n              <label>Donation Type</label>\r\n              <select\r\n                value={donationData.type}\r\n                onChange={(e) => setDonationData({ ...donationData, type: e.target.value })}\r\n              >\r\n                <option value=\"money\">Money</option>\r\n                <option value=\"items\">Items</option>\r\n              </select>\r\n\r\n              {donationData.type === 'money' ? (\r\n                <input\r\n                  type=\"number\"\r\n                  placeholder=\"Enter amount\"\r\n                  value={donationData.amount}\r\n                  onChange={(e) => setDonationData({ ...donationData, amount: e.target.value })}\r\n                  required\r\n                />\r\n              ) : (\r\n                <textarea\r\n                  placeholder=\"Describe the items you want to donate\"\r\n                  value={donationData.itemDetails || ''}\r\n                  onChange={(e) => setDonationData({ ...donationData, itemDetails: e.target.value })}\r\n                  required\r\n                />\r\n              )}\r\n\r\n              <div className=\"modal-actions\">\r\n                <button type=\"submit\">Confirm Donation</button>\r\n                <button type=\"button\" className=\"cancel-btn\" onClick={() => setSelectedCampaign(null)}>\r\n                  Cancel\r\n                </button>\r\n              </div>\r\n            </form>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default BrowseCampaigns;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}